# Base-Clean 文档评分标准规范

> **版本**: v1.0  
> **适用范围**: 所有架构文档（Base/Overlay）  
> **更新日期**: 2025-01-20  
> **状态**: 正式启用

## 📋 总则

Base-Clean评分标准旨在确保架构文档的**可复用性**、**边界清晰**、**技术简洁**、**实施可行**和**运维友好**。所有架构文档必须达到**85分以上**方可合并至主分支。

## 🎯 五维度评分体系（满分100分）

### 1. 可复用性（30分）
**目标**: 确保文档具备跨项目/跨域的高移植性

#### 评分细则
- **占位符规范（12分）**
  - 完全使用 `${DOMAIN_*}`, `${PRODUCT_*}`, `${FEATURE_*}` 等占位符：12分
  - 大部分使用占位符，少量硬编码：8-10分
  - 部分使用占位符，存在业务术语：4-6分
  - 很少或不使用占位符：0-2分

- **Base-Clean合规性（10分）**
  - 严格遵循Base/SSoT原则，零业务耦合：10分
  - 基本遵循，有少量耦合：7-8分
  - 部分遵循，业务耦合较多：4-6分
  - 不遵循Base-Clean原则：0-2分

- **跨项目适用性（8分）**
  - 文档可直接用于不同项目，无需修改：8分
  - 需要少量修改即可适用：6分
  - 需要大量修改才能适用：3-4分
  - 仅适用于当前项目：0-1分

### 2. SSoT边界（20分）
**目标**: 明确章节职责，避免重复其他章节内容

#### 评分细则
- **边界清晰度（8分）**
  - 章节职责明确，边界清晰：8分
  - 边界基本清晰，有少量模糊：6分
  - 边界不够清晰：3-4分
  - 边界混乱：0-1分

- **ADR引用规范（8分）**
  - 前言包含`adr_refs`字段且正文明确引用：8分
  - 正文明确引用但前言缺少字段：6分
  - 有引用但不够明确：3-4分
  - 缺少ADR引用：0-1分

- **避免重复（4分）**
  - 严格引用其他章节，无重复内容：4分
  - 基本引用，有少量重复：3分
  - 部分重复其他章节内容：1-2分
  - 大量重复：0分

### 3. 最小依赖（15分）
**目标**: 技术栈简洁，依赖关系清晰可控

#### 评分细则
- **技术栈简洁性（6分）**
  - 技术选择精炼，依赖最小：6分
  - 技术选择合理，依赖可控：4-5分
  - 技术选择复杂，依赖较多：2-3分
  - 技术选择混乱，依赖复杂：0-1分

- **安全默认配置（5分）**
  - 所有配置都是安全默认值：5分
  - 大部分配置安全：3-4分
  - 部分配置需要调整：1-2分
  - 配置不安全或需要大量调整：0分

- **依赖透明度（4分）**
  - 所有依赖都有明确说明和版本约束：4分
  - 大部分依赖有说明：3分
  - 部分依赖有说明：1-2分
  - 依赖说明不清：0分

### 4. 可执行性（20分）
**目标**: 提供可直接使用的代码片段和测试

#### 评分细则
- **TypeScript契约（8分）**
  - 完整的接口/类型定义，可直接使用：8分
  - 基本完整，需少量补充：6分
  - 部分完整，需要大量补充：3-4分
  - 缺少或不可用：0-1分

- **测试覆盖（8分）**
  - 包含单元测试和集成测试占位/示例：8分
  - 包含单元测试占位：5-6分
  - 包含基础测试示例：2-4分
  - 缺少测试：0-1分

- **代码片段质量（4分）**
  - 所有代码片段可直接运行：4分
  - 大部分代码片段可运行：3分
  - 部分代码片段可运行：1-2分
  - 代码片段不可运行：0分

### 5. 运维门禁（15分）
**目标**: 明确SLO、监控和CI集成要求

#### 评分细则
- **性能指标（6分）**
  - 明确的TP95/SLO阈值和监控策略：6分
  - 基本的性能指标：4-5分
  - 部分性能要求：2-3分
  - 缺少性能指标：0-1分

- **质量门禁（5分）**
  - 完整的CI脚本和质量检查：5分
  - 基本的质量门禁：3-4分
  - 部分质量检查：1-2分
  - 缺少质量门禁：0分

- **监控集成（4分）**
  - 完整的监控和告警策略：4分
  - 基本监控策略：2-3分
  - 简单监控要求：1分
  - 缺少监控：0分

## 📊 评分等级标准

| 分数范围 | 等级 | 状态 | 行动要求 |
|----------|------|------|----------|
| 95-100 | S级 (卓越) | ✅ 标杆文档 | 可作为模板推广 |
| 90-94 | A级 (优秀) | ✅ 直接合并 | 推荐参考 |
| 85-89 | B级 (良好) | ✅ 可合并 | 建议改进 |
| 70-84 | C级 (中等) | ⚠️ 需改进 | 改进后合并 |
| <70 | D级 (不达标) | ❌ 拒绝合并 | 重大修改 |

## 🔍 评分实施流程

### PR检查流程
1. **自评**: 文档作者使用本标准进行自评
2. **同行评议**: 至少一位同事使用本标准进行评分
3. **专家评审**: 架构师进行最终评审
4. **合并决策**: 仅85分以上文档允许合并

### 评分记录格式
```markdown
## Base-Clean评分记录

**文档**: docs/architecture/base/XX-章节名.md  
**评分人**: @reviewer  
**评分日期**: YYYY-MM-DD  

| 维度 | 得分 | 满分 | 说明 |
|------|------|------|------|
| 可复用性 | XX | 30 | 具体评分理由 |
| SSoT边界 | XX | 20 | 具体评分理由 |
| 最小依赖 | XX | 15 | 具体评分理由 |
| 可执行性 | XX | 20 | 具体评分理由 |
| 运维门禁 | XX | 15 | 具体评分理由 |
| **总分** | **XX** | **100** | **等级: X级** |

**改进建议**:
- [ ] 具体改进点1
- [ ] 具体改进点2
```

## 📈 历史评分案例

### 优秀案例 (A级)
- **04-system-context-c4-event-flows-v2.md**: 94分
  - 可复用性28/30, SSoT边界19/20, 最小依赖14/15, 可执行性19/20, 运维门禁14/15
  - **优势**: 规范的ADR引用、CloudEvents兼容、平衡的技术深度

### 改进案例 (B级→A级)
- **04-system-context-c4-event-flows.md**: 85分→目标90分
  - **改进点**: 添加规范的ADR引用结构 (+3分), 简化冗长内容 (+2分)

## 🛠 工具与自动化

### 评分检查脚本
```bash
# 运行文档质量检查
npm run docs:score-check

# 检查特定文档
node scripts/docs-scorer.mjs docs/architecture/base/04-*.md
```

### VS Code扩展推荐
- **Base-Clean Linter**: 实时检查占位符使用
- **ADR Validator**: 验证ADR引用完整性
- **Mermaid Preview**: 预览架构图表

## 📋 检查清单

### 文档提交前自检
- [ ] 所有业务术语已替换为占位符
- [ ] 前言包含完整的adr_refs字段
- [ ] 正文明确引用相关ADR
- [ ] 包含可执行的TypeScript代码片段
- [ ] 包含测试占位或示例
- [ ] 明确性能指标和SLO
- [ ] 避免重复其他章节内容
- [ ] 技术依赖最小化
- [ ] 包含监控和门禁要求

### PR Review检查
- [ ] 使用本标准进行量化评分
- [ ] 总分达到85分以上
- [ ] 改进建议具体可行
- [ ] 评分记录完整规范

## 🔄 标准维护

### 更新频率
- **季度回顾**: 每季度回顾评分标准的有效性
- **案例更新**: 及时添加新的优秀案例和改进案例
- **标准调整**: 根据项目发展调整评分权重

### 反馈机制
评分标准问题请提交至: [docs/issues](链接占位)

---

**生效日期**: 2025-01-20  
**下次回顾**: 2025-04-20
issue, severity, confidence, filename, location, sample, description, url
AVAILABLE_SECURITY_FIXES_GLOBAL_CHECK,"INFORMATIONAL","TENTATIVE","C:\buildgame\vitegame\package.json","0:0",N/A,"Check if there are security patches applied in between the Electron version used and the latest",https://github.com/doyensec/electronegativity/wiki/AVAILABLE_SECURITY_FIXES_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","FIRM","C:\buildgame\vitegame\index.html","7:0","default-src 'none'; script-src 'self'; style-src 'self'; img-src 'self' data: blob:; font-src 'self'; connect-src 'self' https://sentry.io https://*.sentry.io; object-src 'none'; base-uri 'none'; form-action 'self'; frame-ancestors 'none';","One or more CSP directives detected seems to be vulnerable",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","FIRM","C:\buildgame\vitegame\dist-electron\main.js","110:8","default-src 'none'; script-src 'self'; style-src 'self'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://sentry.io; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';","One or more CSP directives detected seems to be vulnerable",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","FIRM","C:\buildgame\vitegame\dist\index.html","7:0","default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://sentry.io; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';","One or more CSP directives detected seems to be vulnerable",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","TENTATIVE","C:\buildgame\vitegame\electron\main.ts","111:10",N/A,"Failed to parse CSP, it may not be valid.",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","TENTATIVE","C:\buildgame\vitegame\electron\security.ts","134:4",N/A,"Failed to parse CSP, it may not be valid.",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","TENTATIVE","C:\buildgame\vitegame\tests\e2e\guild-manager\security.e2e.spec.ts","1112:8",N/A,"Failed to parse CSP, it may not be valid.",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
CSP_GLOBAL_CHECK,"LOW","FIRM","C:\buildgame\vitegame\src\renderer\index.html","6:0","default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; object-src 'none'; base-uri 'self'; frame-ancestors 'none'","One or more CSP directives detected seems to be vulnerable",https://github.com/doyensec/electronegativity/wiki/CSP_GLOBAL_CHECK
AUXCLICK_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\dist-electron\main.js","16:21","const mainWindow = new BrowserWindow({","Limit navigation flows to untrusted origins. Middle-click may cause Electron to open a link within a new window",https://github.com/doyensec/electronegativity/wiki/AUXCLICK_JS_CHECK
PRELOAD_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\dist-electron\main.js","22:6","preload: join(__dirname, 'preload.js'),","Review the use of preload scripts",https://github.com/doyensec/electronegativity/wiki/PRELOAD_JS_CHECK
OPEN_EXTERNAL_JS_CHECK,"MEDIUM","TENTATIVE","C:\buildgame\vitegame\dist-electron\main.js","102:4","shell.openExternal(details.url);","Review the use of openExternal",https://github.com/doyensec/electronegativity/wiki/OPEN_EXTERNAL_JS_CHECK
DANGEROUS_FUNCTIONS_JS_CHECK,"MEDIUM","CERTAIN","C:\buildgame\vitegame\dist\assets\index-Ceidsprl.js","6630:45094","*/g.exports={Format:t(27902),Pad:t(41836),RemoveAt:t(33628),Reverse:t(27671),UppercaseFirst:t(35355),UUID:t(45650)}}},tt={};function nt(g){var A=tt[g];if(A!==void 0)return A.exports;var t=tt[g]={exports:{}};return j[g](t,t.exports,nt),t.exports}nt.g=function(){if(typeof globalThis==""object"")return globalThis;try{return this||new Function(""return this"")()}catch{if(typeof window==""object"")return window}}();var dt=nt(85454);return dt})())}(bh)),bh.exports}var cE=dE();const Wn=tE(cE);class xy extends Wn.Scene{eventCallbacks=new Map;constructor(V){super(V)}publishEvent(V){this.events.emit(""domain-event"",V)}subscribeEvent(V,j){this.eventCallbacks.has(V)||this.eventCallbacks.set(V,[]),this.eventCallbacks.get(V).push(j)}unsubscribeEvent(V,j){const tt=this.eventCallbacks.get(V);if(tt){const nt=tt.indexOf(j);nt>-1&&tt.splice(nt,1)}}destroy(){this.eventCallbacks.clear(),super.destroy()}create(){this.initializeScene(),this.events.on(""update"",this.updateScene,this)}update(V,j){this.updateScene(V,j)}}class vE extends xy{menuButtons=[];constructor(){super({key:""MenuScene""})}preload(){}initializeScene(){this.setupBackground(),this.setupTitle(),this.setupMenu(),this.setupInput(),this.publishEvent({type:""game.menu.initialized"",source:""menu-scene"",data:{scene:""MenuScene""},timestamp:new Date,id:`menu-init-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}setupBackground(){this.cameras.main.setBackgroundColor(""#0f172a"");const V=this.add.graphics();V.lineStyle(2,1976635,.8);for(let j=0;j<10;j++){const tt=Wn.Math.Between(0,this.scale.width),nt=Wn.Math.Between(0,this.scale.height),dt=Wn.Math.Between(50,200),g=Wn.Math.Between(0,360)*Math.PI/180;V.moveTo(tt,nt),V.lineTo(tt+Math.cos(g)*dt,nt+Math.sin(g)*dt)}V.strokePath()}setupTitle(){const V=this.scale.width/2,j=this.add.text(V,150,""公会经理"",{font:""bold 48px Arial"",color:""#ffffff"",stroke:""#3182ce"",strokeThickness:3}).setOrigin(.5);this.add.text(V,200,""Guild Manager"",{font:""24px Arial"",color:""#94a3b8""}).setOrigin(.5),this.tweens.add({targets:j,scaleX:1.1,scaleY:1.1,duration:2e3,ease:""Sine.easeInOut"",yoyo:!0,repeat:-1})}setupMenu(){const V=this.scale.width/2,j=300,tt=60;[{text:""开始游戏"",action:""start-game""},{text:""加载存档"",action:""load-game""},{text:""设置"",action:""settings""},{text:""退出"",action:""exit""}].forEach((dt,g)=>{const A=this.add.text(V,j+g*tt,dt.text,{font:""32px Arial"",color:""#e2e8f0"",backgroundColor:""#1e293b"",padding:{x:20,y:10}}).setOrigin(.5);A.setInteractive(),A.setData(""action"",dt.action),A.on(""pointerover"",()=>{A.setStyle({color:""#ffffff"",backgroundColor:""#3182ce""}),this.tweens.add({targets:A,scaleX:1.1,scaleY:1.1,duration:200,ease:""Power2""})}),A.on(""pointerout"",()=>{A.setStyle({color:""#e2e8f0"",backgroundColor:""#1e293b""}),this.tweens.add({targets:A,scaleX:1,scaleY:1,duration:200,ease:""Power2""})}),A.on(""pointerdown"",()=>{this.handleMenuAction(dt.action)}),this.menuButtons.push(A)})}setupInput(){this.input.keyboard.on(""keydown-ENTER"",()=>{const V=this.menuButtons.find(j=>j.style.backgroundColor===""#3182ce"");V?this.handleMenuAction(V.getData(""action"")):this.handleMenuAction(""start-game"")}),this.input.keyboard.on(""keydown-ESC"",()=>{this.handleMenuAction(""exit"")})}handleMenuAction(V){switch(this.publishEvent({type:""game.menu.action"",source:""menu-scene"",data:{action:V},timestamp:new Date,id:`menu-action-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),V){case""start-game"":this.cameras.main.fade(500,0,0,0),this.cameras.main.once(""camerafadeoutcomplete"",()=>{this.scene.start(""GameScene"")});break;case""load-game"":console.log(""Load game not implemented yet"");break;case""settings"":console.log(""Settings not implemented yet"");break;case""exit"":this.publishEvent({type:""game.exit.requested"",source:""menu-scene"",data:{reason:""user_menu_selection""},timestamp:new Date,id:`exit-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""});break}}updateScene(V,j){}}class pE extends xy{gameState={level:1,score:0,health:100,inventory:[],position:{x:400,y:300},timestamp:new Date};player;ui;constructor(){super({key:""GameScene""}),this.ui={}}preload(){this.load.image(""player"",""data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==""),this.load.on(""progress"",V=>{this.publishEvent({type:""game.loading.progress"",source:""game-scene"",data:{progress:V},timestamp:new Date,id:`loading-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})})}initializeScene(){this.setupBackground(),this.setupPlayer(),this.setupUI(),this.setupInput(),this.setupPhysics(),this.publishEvent({type:""game.scene.initialized"",source:""game-scene"",data:{scene:""GameScene""},timestamp:new Date,id:`scene-init-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}setupBackground(){this.cameras.main.setBackgroundColor(""#1a202c"");const V=this.add.graphics();V.lineStyle(1,3355443,.5);const j=50;for(let tt=0;tt<this.scale.width;tt+=j)V.moveTo(tt,0),V.lineTo(tt,this.scale.height);for(let tt=0;tt<this.scale.height;tt+=j)V.moveTo(0,tt),V.lineTo(this.scale.width,tt);V.strokePath()}setupPlayer(){const V=this.gameState.position;this.player=this.add.graphics(),this.player.fillStyle(3244750,1),this.player.fillCircle(0,0,20),this.player.x=V.x,this.player.y=V.y,this.physics.add.existing(this.player),this.player.body.setCollideWorldBounds(!0)}setupUI(){this.ui.scoreText=this.add.text(20,20,`分数: ${this.gameState.score}`,{font:""18px Arial"",color:""#ffffff"",backgroundColor:""#000000"",padding:{x:10,y:5}}),this.ui.healthText=this.add.text(20,50,`生命值: ${this.gameState.health}`,{font:""18px Arial"",color:""#ffffff"",backgroundColor:""#000000"",padding:{x:10,y:5}}),this.ui.levelText=this.add.text(20,80,`等级: ${this.gameState.level}`,{font:""18px Arial"",color:""#ffffff"",backgroundColor:""#000000"",padding:{x:10,y:5}}),this.ui.scoreText.setDepth(100),this.ui.healthText.setDepth(100),this.ui.levelText.setDepth(100)}setupInput(){const V=this.input.keyboard.createCursorKeys(),j=this.input.keyboard.addKeys(""W,S,A,D"");this.input.on(""pointerdown"",tt=>{this.handleInput({type:""mouse"",action:""click"",data:{x:tt.x,y:tt.y,button:tt.button},timestamp:new Date})}),this.input.keyboard.on(""keydown"",tt=>{this.handleInput({type:""keyboard"",action:""keydown"",data:{key:tt.key,code:tt.code},timestamp:new Date})}),this.cursors=V,this.wasd=j}setupPhysics(){this.physics.world.setBounds(0,0,this.scale.width,this.scale.height)}handleInput(V){if(!this.player)return;const j=200,tt=this.player.body;switch(V.action){case""click"":if(V.type===""mouse""){const nt=V.data.x,dt=V.data.y;this.tweens.add({targets:this.player,x:nt,y:dt,duration:500,ease:""Power2""}),this.gameState.position={x:nt,y:dt}}break;case""keydown"":if(V.type===""keyboard"")switch(V.data.key.toLowerCase()){case""w"":case""arrowup"":tt.setVelocityY(-j);break;case""s"":case""arrowdown"":tt.setVelocityY(j);break;case""a"":case""arrowleft"":tt.setVelocityX(-j);break;case""d"":case""arrowright"":tt.setVelocityX(j);break;case"" "":this.scene.pause(),this.publishEvent({type:""game.state.paused"",source:""game-scene"",data:{reason:""user_input""},timestamp:new Date,id:`pause-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""});break}break}this.publishEvent({type:""game.input.processed"",source:""game-scene"",data:{input:V},timestamp:new Date,id:`input-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}updateScene(V,j){if(!this.player)return;this.gameState.position={x:this.player.x,y:this.player.y},this.gameState.timestamp=new Date;const tt=this.cursors,nt=this.wasd,dt=this.player.body;if(tt||nt){let g=0,A=0;tt.left.isDown||nt.A.isDown?g=-200:(tt.right.isDown||nt.D.isDown)&&(g=200),tt.up.isDown||nt.W.isDown?A=-200:(tt.down.isDown||nt.S.isDown)&&(A=200),dt.setVelocity(g,A)}V%1e3<j&&this.publishEvent({type:""game.state.updated"",source:""game-scene"",data:{gameState:this.gameState},timestamp:new Date,id:`state-update-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}getGameState(){return{...this.gameState}}setGameState(V){this.gameState={...this.gameState,...V},this.ui.scoreText&&V.score!==void 0&&this.ui.scoreText.setText(`分数: ${V.score}`),this.ui.healthText&&V.health!==void 0&&this.ui.healthText.setText(`生命值: ${V.health}`),this.ui.levelText&&V.level!==void 0&&this.ui.levelText.setText(`等级: ${V.level}`),this.publishEvent({type:""game.state.changed"",source:""game-scene"",data:{gameState:this.gameState},timestamp:new Date,id:`state-change-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}}class mE{game=null;config;eventCallback;constructor(V={}){this.config=V,this.eventCallback=V.onEvent}initialize(V,j=800,tt=600){return new Promise((nt,dt)=>{try{const g={type:Wn.AUTO,width:j,height:tt,parent:V,backgroundColor:""#1a202c"",physics:{default:""arcade"",arcade:{gravity:{x:0,y:0},debug:!1}},scale:{mode:Wn.Scale.FIT,autoCenter:Wn.Scale.CENTER_BOTH,min:{width:400,height:300},max:{width:1600,height:1200}},scene:[vE,pE],callbacks:{postBoot:()=>{this.setupEventHandlers(),nt()}}};this.game=new Wn.Game(g)}catch(g){this.config.onError?.(g),dt(g)}})}setupEventHandlers(){if(!this.game)return;this.game.events.on(""domain-event"",j=>{this.handleDomainEvent(j)});const V=this.game.scene;[""MenuScene"",""GameScene""].forEach(j=>{const tt=V.getScene(j);tt&&tt.events.on(""domain-event"",nt=>{this.eventCallback?.(nt)})})}handleDomainEvent(V){switch(console.log(""Domain Event:"",V),V.type){case""game.menu.action"":this.handleMenuAction(V);break;case""game.state.paused"":this.handleGamePaused(V);break;case""game.exit.requested"":this.handleExitRequested(V);break;case""game.error"":this.handleGameError(V);break}this.eventCallback?.(V)}handleMenuAction(V){const{action:j}=V.data;switch(j){case""start-game"":this.startGame();break;case""exit"":this.exitGame();break}}handleGamePaused(V){console.log(""Game paused:"",V.data)}handleExitRequested(V){this.exitGame()}handleGameError(V){const j=V.data;this.config.onError?.(new Error(j.error),j.scene)}startGame(){if(!this.game)return;this.game.scene.getScene(""GameScene"")&&this.game.scene.start(""GameScene"")}pauseGame(){if(!this.game)return;const V=this.game.scene.getScene(""GameScene"");V&&V.scene.isActive()&&V.scene.pause()}resumeGame(){if(!this.game)return;const V=this.game.scene.getScene(""GameScene"");V&&V.scene.isPaused()&&V.scene.resume()}restartGame(){this.game&&this.game.scene.start(""GameScene"")}returnToMenu(){this.game&&this.game.scene.start(""MenuScene"")}exitGame(){this.game&&(this.game.destroy(!0),this.game=null)}getCurrentScene(){if(!this.game)return null;const V=this.game.scene.getScenes(!0);return V.length>0?V[0]:null}getGameState(){if(!this.game)return null;const V=this.game.scene.getScene(""GameScene"");return V&&V.scene.isActive()?V.getGameState():null}setGameState(V){if(!this.game)return;const j=this.game.scene.getScene(""GameScene"");j&&j.scene.isActive()&&j.setGameState(V)}isInitialized(){return this.game!==null}destroy(){this.exitGame(),this.eventCallback=void 0}}class gE{options;autoSaveTimer;currentState=null;currentConfig=null;eventCallbacks=new Set;constructor(V={}){this.options={storageKey:""guild-manager-game"",maxSaves:10,autoSaveInterval:3e4,enableCompression:!0,...V}}setState(V,j){this.currentState={...V},j&&(this.currentConfig={...j}),this.publishEvent({type:""game.state.manager.updated"",source:""game-state-manager"",data:{state:V,config:j},timestamp:new Date,id:`state-update-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}getState(){return this.currentState?{...this.currentState}:null}getConfig(){return this.currentConfig?{...this.currentConfig}:null}async saveGame(V,j){if(!this.currentState||!this.currentConfig)throw new Error(""No game state to save"");const tt=`${this.options.storageKey}-${Date.now()}`,nt={id:tt,state:{...this.currentState},config:{...this.currentConfig},metadata:{createdAt:new Date,updatedAt:new Date,version:""1.0.0"",checksum:await this.calculateChecksum(this.currentState)},screenshot:j};try{return await this.saveToBrowser(tt,nt),await this.cleanupOldSaves(),this.publishEvent({type:""game.save.created"",source:""game-state-manager"",data:{saveId:tt,saveData:{...nt,state:void 0}},timestamp:new Date,id:`save-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),tt}catch(dt){throw this.publishEvent({type:""game.save.failed"",source:""game-state-manager"",data:{error:dt.message},timestamp:new Date,id:`save-error-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),dt}}async loadGame(V){try{const j=await this.loadFromBrowser(V);if(await this.calculateChecksum(j.state)!==j.metadata.checksum)throw new Error(""Save file is corrupted"");return this.currentState={...j.state},this.currentConfig={...j.config},this.publishEvent({type:""game.save.loaded"",source:""game-state-manager"",data:{saveId:V,state:this.currentState,config:this.currentConfig},timestamp:new Date,id:`load-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),{state:{...j.state},config:{...j.config}}}catch(j){throw this.publishEvent({type:""game.save.load_failed"",source:""game-state-manager"",data:{saveId:V,error:j.message},timestamp:new Date,id:`load-error-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),j}}async getSaveList(){try{const V=[],j=Object.keys(localStorage);for(const tt of j)if(tt.startsWith(this.options.storageKey))try{const nt=await this.loadFromBrowser(tt);V.push(nt)}catch(nt){console.warn(`Failed to load save: ${tt}`,nt)}return V.sort((tt,nt)=>new Date(nt.metadata.createdAt).getTime()-new Date(tt.metadata.createdAt).getTime()),V}catch(V){return console.error(""Failed to get save list:"",V),[]}}async deleteSave(V){try{localStorage.removeItem(V),this.publishEvent({type:""game.save.deleted"",source:""game-state-manager"",data:{saveId:V},timestamp:new Date,id:`delete-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}catch(j){throw this.publishEvent({type:""game.save.delete_failed"",source:""game-state-manager"",data:{saveId:V,error:j.message},timestamp:new Date,id:`delete-error-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),j}}enableAutoSave(){this.autoSaveTimer||(this.autoSaveTimer=setInterval(async()=>{if(this.currentState&&this.currentConfig)try{const V=await this.saveGame(`auto-save-${Date.now()}`);this.publishEvent({type:""game.autosave.completed"",source:""game-state-manager"",data:{saveId:V},timestamp:new Date,id:`autosave-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}catch(V){this.publishEvent({type:""game.autosave.failed"",source:""game-state-manager"",data:{error:V.message},timestamp:new Date,id:`autosave-error-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}},this.options.autoSaveInterval),this.publishEvent({type:""game.autosave.enabled"",source:""game-state-manager"",data:{interval:this.options.autoSaveInterval},timestamp:new Date,id:`autosave-enable-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}))}disableAutoSave(){this.autoSaveTimer&&(clearInterval(this.autoSaveTimer),this.autoSaveTimer=void 0,this.publishEvent({type:""game.autosave.disabled"",source:""game-state-manager"",data:{},timestamp:new Date,id:`autosave-disable-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}))}onEvent(V){this.eventCallbacks.add(V)}offEvent(V){this.eventCallbacks.delete(V)}destroy(){this.disableAutoSave(),this.eventCallbacks.clear(),this.currentState=null,this.currentConfig=null}async saveToBrowser(V,j){const tt=JSON.stringify(j);if(tt.length>5*1024*1024)throw new Error(""Save data too large"");localStorage.setItem(V,tt)}async loadFromBrowser(V){const j=localStorage.getItem(V);if(!j)throw new Error(`Save not found: ${V}`);return JSON.parse(j)}async cleanupOldSaves(){const V=await this.getSaveList();if(V.length>this.options.maxSaves){const j=V.slice(this.options.maxSaves);for(const tt of j)try{await this.deleteSave(tt.id)}catch(nt){console.warn(`Failed to delete old save: ${tt.id}`,nt)}}}async calculateChecksum(V){const j=JSON.stringify(V,Object.keys(V).sort());let tt=0;for(let nt=0;nt<j.length;nt++){const dt=j.charCodeAt(nt);tt=(tt<<5)-tt+dt,tt=tt&tt}return tt.toString(16)}publishEvent(V){this.eventCallbacks.forEach(j=>{try{j(V)}catch(tt){console.error(""Error in state manager event callback:"",tt)}})}}class xE{sources=new Map;priorities=new Map;lastStates=new Map;syncTimer;options;eventCallbacks=new Set;isDestroyed=!1;constructor(V={}){this.options={syncInterval:1e3,conflictResolution:""latest"",enableBidirectionalSync:!0,...V}}registerSource(V,j=0){if(this.isDestroyed)return;this.sources.set(V.id,V),this.priorities.set(V.id,j);const tt=V.getState();tt&&this.lastStates.set(V.id,{...tt}),this.publishEvent({type:""state.synchronizer.source_registered"",source:""state-synchronizer"",data:{sourceId:V.id,priority:j},timestamp:new Date,id:`register-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}unregisterSource(V){this.isDestroyed||(this.sources.delete(V),this.priorities.delete(V),this.lastStates.delete(V),this.publishEvent({type:""state.synchronizer.source_unregistered"",source:""state-synchronizer"",data:{sourceId:V},timestamp:new Date,id:`unregister-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}))}startSync(){this.isDestroyed||this.syncTimer||(this.syncTimer=setInterval(()=>{this.performSync()},this.options.syncInterval),this.publishEvent({type:""state.synchronizer.started"",source:""state-synchronizer"",data:{interval:this.options.syncInterval},timestamp:new Date,id:`sync-start-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}))}stopSync(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=void 0,this.publishEvent({type:""state.synchronizer.stopped"",source:""state-synchronizer"",data:{},timestamp:new Date,id:`sync-stop-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}))}sync(){this.isDestroyed||this.performSync()}forceState(V,j){if(!this.isDestroyed){for(const[tt,nt]of this.sources)if(tt!==j)try{nt.setState(V),this.lastStates.set(tt,{...V})}catch(dt){console.error(`Failed to set state for source ${tt}:`,dt)}this.publishEvent({type:""state.synchronizer.forced"",source:""state-synchronizer"",data:{state:V,excludeSourceId:j},timestamp:new Date,id:`force-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}}getMergedState(){if(this.isDestroyed||this.sources.size===0)return null;const V=[];for(const[j,tt]of this.sources){const nt=tt.getState();nt&&V.push({sourceId:j,state:nt,priority:this.priorities.get(j)||0})}if(V.length===0)return null;if(V.length===1)return{...V[0].state};switch(this.options.conflictResolution){case""priority"":return this.mergeByPriority(V);case""latest"":return this.mergeByTimestamp(V);case""merge"":return this.mergeFields(V);default:return V[0].state}}onEvent(V){this.eventCallbacks.add(V)}offEvent(V){this.eventCallbacks.delete(V)}destroy(){this.isDestroyed=!0,this.stopSync(),this.sources.clear(),this.priorities.clear(),this.lastStates.clear(),this.eventCallbacks.clear()}performSync(){if(this.isDestroyed||this.sources.size===0)return;const V=[],j=new Map;for(const[tt,nt]of this.sources){const dt=nt.getState();if(dt){j.set(tt,dt);const g=this.lastStates.get(tt);(!g||this.hasStateChanged(g,dt))&&(V.push(tt),this.lastStates.set(tt,{...dt}))}}V.length>0&&this.synchronizeStates(V,j)}synchronizeStates(V,j){const tt=this.determineAuthoritativeState(V,j);if(!tt)return;const{sourceId:nt,state:dt}=tt;let g=0;for(const[A,t]of this.sources)if(A!==nt&&this.options.enableBidirectionalSync)try{t.setState(dt),this.lastStates.set(A,{...dt}),g++}catch(c){console.error(`Failed to sync state to source ${A}:`,c)}g>0&&this.publishEvent({type:""state.synchronizer.synced"",source:""state-synchronizer"",data:{authoritativeSource:nt,syncedSources:Array.from(this.sources.keys()).filter(A=>A!==nt),state:dt},timestamp:new Date,id:`sync-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}determineAuthoritativeState(V,j){const tt=V.map(nt=>({sourceId:nt,state:j.get(nt),priority:this.priorities.get(nt)||0}));switch(this.options.conflictResolution){case""priority"":return tt.reduce((dt,g)=>g.priority>dt.priority?g:dt);case""latest"":return tt.reduce((dt,g)=>g.state.timestamp>dt.state.timestamp?g:dt);case""merge"":return tt.reduce((dt,g)=>g.priority>dt.priority?g:dt);default:return tt[0]||null}}mergeByPriority(V){return V.sort((j,tt)=>tt.priority-j.priority)[0].state}mergeByTimestamp(V){return V.sort((j,tt)=>tt.state.timestamp.getTime()-j.state.timestamp.getTime())[0].state}mergeFields(V){const tt={...V[0].state};for(const{state:nt}of V)Object.keys(nt).forEach(dt=>{const g=dt;nt.timestamp>tt.timestamp&&(tt[g]=nt[g])});return tt}hasStateChanged(V,j){return JSON.stringify(V)!==JSON.stringify(j)}publishEvent(V){this.eventCallbacks.forEach(j=>{try{j(V)}catch(tt){console.error(""Error in synchronizer event callback:"",tt)}})}}var Mi=(st=>(st[st.LOW=0]=""LOW"",st[st.NORMAL=1]=""NORMAL"",st[st.HIGH=2]=""HIGH"",st[st.CRITICAL=3]=""CRITICAL"",st))(Mi||{});class yE{listeners=new Map;eventQueue=[];isProcessing=!1;subscriptionIdCounter=0;options;metrics={eventsPublished:0,eventsProcessed:0,averageProcessingTime:0,lastEventTime:0};constructor(V={}){this.options={maxListeners:V.maxListeners??100,enableLogging:V.enableLogging??!0,enableMetrics:V.enableMetrics??!0,queueSize:V.queueSize??1e3}}subscribe(V,j,tt={}){const nt=`sub_${++this.subscriptionIdCounter}`;this.listeners.has(V)||this.listeners.set(V,[]);const dt=this.listeners.get(V);if(dt.length>=this.options.maxListeners)throw new Error(`Maximum listeners (${this.options.maxListeners}) exceeded for event: ${V}`);const g={id:nt,handler:j,priority:tt.priority??Mi.NORMAL,once:tt.once??!1,context:tt.context};return dt.push(g),dt.sort((A,t)=>t.priority-A.priority),this.options.enableLogging&&console.log(`[EventBus] Subscribed to ${V} (ID: ${nt}, Context: ${tt.context||""unknown""})`),nt}unsubscribe(V){for(const[j,tt]of this.listeners.entries()){const nt=tt.findIndex(dt=>dt.id===V);if(nt!==-1)return tt.splice(nt,1),tt.length===0&&this.listeners.delete(j),this.options.enableLogging&&console.log(`[EventBus] Unsubscribed from ${j} (ID: ${V})`),!0}return!1}unsubscribeAll(V){const j=this.listeners.get(V);if(j){const tt=j.length;return this.listeners.delete(V),this.options.enableLogging&&console.log(`[EventBus] Unsubscribed all (${tt}) listeners from ${V}`),tt}return 0}publish(V,j){const tt={...V,metadata:{id:`evt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,source:j?.source||""unknown"",priority:j?.priority||Mi.NORMAL,persistent:j?.persistent||!1,broadcast:j?.broadcast||!0,...j}};this.metrics.eventsPublished++,this.options.enableLogging&&console.log(`[EventBus] Publishing event: ${V.type}`,tt),this.processEvent(tt)}async publishAsync(V,j){const tt={...V,metadata:{id:`evt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,source:j?.source||""unknown"",priority:j?.priority||Mi.NORMAL,persistent:j?.persistent||!1,broadcast:j?.broadcast||!0,...j}};this.eventQueue.length>=this.options.queueSize&&(console.warn(`[EventBus] Event queue full (${this.options.queueSize}), dropping oldest event`),this.eventQueue.shift()),this.eventQueue.push(tt),this.metrics.eventsPublished++,this.isProcessing||await this.processEventQueue()}processEvent(V){const j=performance.now(),tt=this.listeners.get(V.type)||[];if(tt.length===0){this.options.enableLogging&&console.warn(`[EventBus] No listeners for event: ${V.type}`);return}const nt=[];for(const dt of tt)try{const g=dt.handler(V);g instanceof Promise&&g.catch(A=>{console.error(`[EventBus] Async handler error for ${V.type}:`,A)}),dt.once&&nt.push(dt.id)}catch(g){console.error(`[EventBus] Handler error for ${V.type}:`,g)}if(nt.forEach(dt=>this.unsubscribe(dt)),this.options.enableMetrics){const dt=performance.now()-j;this.metrics.eventsProcessed++,this.metrics.averageProcessingTime=(this.metrics.averageProcessingTime*(this.metrics.eventsProcessed-1)+dt)/this.metrics.eventsProcessed,this.metrics.lastEventTime=Date.now()}}async processEventQueue(){if(!this.isProcessing){this.isProcessing=!0;try{for(;this.eventQueue.length>0;){const V=this.eventQueue.shift();V.metadata.priority>=Mi.HIGH?this.processEvent(V):(await new Promise(j=>setTimeout(j,0)),this.processEvent(V))}}finally{this.isProcessing=!1}}}getListenerStats(){const V={};for(const[j,tt]of this.listeners.entries())V[j]=tt.length;return V}getMetrics(){return{...this.metrics}}destroy(){this.listeners.clear(),this.eventQueue.length=0,this.isProcessing=!1,this.options.enableLogging&&console.log(""[EventBus] EventBus destroyed"")}hasListeners(V){const j=this.listeners.get(V);return j?j.length>0:!1}getListenerCount(V){const j=this.listeners.get(V);return j?j.length:0}}const Hn=new yE({maxListeners:200,enableLogging:!0,enableMetrics:!0,queueSize:2e3});function TE(st={}){const{context:V=""react-component"",priority:j=Mi.NORMAL,enableAutoCleanup:tt=!0}=st,nt=Yt.useRef([]),dt=Yt.useRef(Hn),g=Yt.useCallback((i,l,u={})=>{const d=dt.current.subscribe(i,l,{priority:u.priority||j,once:u.once||!1,context:V});return nt.current.push({eventType:i,subscriptionId:d}),d},[V,j]),A=Yt.useCallback(i=>{const l=dt.current.unsubscribe(i);return l&&(nt.current=nt.current.filter(u=>u.subscriptionId!==i)),l},[]),t=Yt.useCallback(i=>{dt.current.publish(i,{source:V,priority:j})},[V,j]),c=Yt.useCallback(async i=>{await dt.current.publishAsync(i,{source:V,priority:j})},[V,j]),m=Yt.useCallback((i,l)=>{const d={pause:{type:""react.command.pause"",data:{timestamp:new Date}},resume:{type:""react.command.resume"",data:{timestamp:new Date}},save:{type:""react.command.save"",data:{saveId:l?.saveId,timestamp:new Date}},load:{type:""react.command.load"",data:{saveId:l?.saveId,timestamp:new Date}},restart:{type:""react.command.restart"",data:{timestamp:new Date}}}[i];d&&t(d)},[t]),o=Yt.useCallback((i,l=!1)=>{const u=g(""phaser.response.ready"",i,{once:l}),d=g(""phaser.response.completed"",i,{once:l});return[u,d]},[g]),s=Yt.useCallback(i=>{const l=g(""game.state.updated"",i),u=g(""game.state.changed"",i);return[l,u]},[g]),r=Yt.useCallback(i=>{const l=g(""game.error"",i),u=g(""game.warning"",i);return[l,u]},[g]),e=Yt.useCallback(()=>({listenerStats:dt.current.getListenerStats(),metrics:dt.current.getMetrics(),activeSubscriptions:nt.current.length}),[]),n=Yt.useCallback(i=>dt.current.hasListeners(i),[]),h=Yt.useCallback(()=>{nt.current.forEach(({subscriptionId:i})=>{dt.current.unsubscribe(i)}),nt.current=[]},[]);return Yt.useEffect(()=>{if(tt)return h},[h,tt]),Yt.useMemo(()=>({subscribe:g,unsubscribe:A,publish:t,publishAsync:c,sendCommandToPhaser:m,onPhaserResponse:o,onGameStateChange:s,onGameError:r,getStats:e,hasListeners:n,cleanup:h,eventBus:dt.current}),[g,A,t,c,m,o,s,r,e,n,h])}class SE{running=!1;last=0;rafId=null;update;onError;constructor(V,j){this.update=V,this.onError=j}start(){if(this.running)return;this.running=!0,this.last=performance.now();const V=async j=>{if(!this.running)return;const tt=j-this.last;this.last=j;try{await this.update(tt)}catch(nt){this.onError?.(nt)}this.rafId=setTimeout(()=>V(performance.now()),16)};V(this.last)}stop(){this.running=!1,this.rafId&&clearTimeout(this.rafId)}}class EE{state=""boot"";get current(){return this.state}transition(V){if(!{boot:[""loading"",""error""],loading:[""running"",""error""],running:[""paused"",""error""],paused:[""running"",""error""],error:[""boot""]}[this.state].includes(V))throw new Error(`Invalid transition ${this.state} -> ${V}`);this.state=V}}class CE{sceneManager;gameLoop;stateMachine;stateManager;stateSynchronizer;eventCallbacks=new Set;eventBusSubscriptions=[];currentConfig;currentState;container;gameStartTime=0;gameStatistics={totalMoves:0,itemsCollected:0,enemiesDefeated:0,distanceTraveled:0,averageReactionTime:0};constructor(){this.stateMachine=new EE,this.stateManager=new gE({storageKey:""guild-manager-game"",maxSaves:10,autoSaveInterval:3e4,enableCompression:!0}),this.stateSynchronizer=new xE({syncInterval:1e3,conflictResolution:""priority"",enableBidirectionalSync:!0}),this.sceneManager=new mE({onEvent:V=>{this.handleDomainEvent(V)},onError:(V,j)=>{console.error(""Game engine error:"",V,j),this.stateMachine.transition(""error"")}}),this.gameLoop=new SE(V=>this.updateGame(V),V=>{console.error(""Game loop error:"",V),this.stateMachine.transition(""error"")}),this.currentState={id:`game-${Date.now()}`,level:1,score:0,health:100,inventory:[],position:{x:400,y:300},timestamp:new Date},this.stateManager.onEvent(V=>this.handleDomainEvent(V)),this.stateSynchronizer.onEvent(V=>this.handleDomainEvent(V)),this.setupEventBusListeners(),this.stateSynchronizer.registerSource({id:""game-engine"",getState:()=>this.currentState,setState:V=>{this.currentState={...V},this.stateManager.setState(V,this.currentConfig)}},10),this.stateSynchronizer.startSync()}async initializeGame(V){try{return this.stateMachine.transition(""loading""),this.currentConfig=V,this.currentState={id:`game-${Date.now()}`,level:1,score:0,health:V.initialHealth,inventory:[],position:{x:400,y:300},timestamp:new Date},this.gameStatistics={totalMoves:0,itemsCollected:0,enemiesDefeated:0,distanceTraveled:0,averageReactionTime:0},this.publishEvent({type:""game.engine.initialized"",source:""game-engine-adapter"",data:{config:V,state:this.currentState},timestamp:new Date,id:`init-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),this.stateMachine.transition(""running""),this.currentState}catch(j){throw this.stateMachine.transition(""error""),j}}async startGame(V){if(!this.container)throw new Error(""Game container not set. Call setContainer() first."");try{return V&&await this.loadGame(V),this.sceneManager.isInitialized()||await this.sceneManager.initialize(this.container,800,600),this.gameLoop.start(),this.gameStartTime=Date.now(),this.publishEvent({type:""game.session.started"",source:""game-engine-adapter"",data:{saveId:V,state:this.currentState,timestamp:this.gameStartTime},timestamp:new Date,id:`start-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),this.currentState}catch(j){throw this.stateMachine.transition(""error""),j}}async pauseGame(){this.gameLoop.stop(),this.sceneManager.pauseGame(),this.stateMachine.transition(""paused""),this.publishEvent({type:""game.session.paused"",source:""game-engine-adapter"",data:{state:this.currentState},timestamp:new Date,id:`pause-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}async resumeGame(){this.gameLoop.start(),this.sceneManager.resumeGame(),this.stateMachine.transition(""running""),this.publishEvent({type:""game.session.resumed"",source:""game-engine-adapter"",data:{state:this.currentState},timestamp:new Date,id:`resume-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}async saveGame(){if(!this.currentState||!this.currentConfig)throw new Error(""No game state to save"");this.stateManager.setState(this.currentState,this.currentConfig);const V=await this.stateManager.saveGame();return this.publishEvent({type:""game.save.completed"",source:""game-engine-adapter"",data:{saveId:V},timestamp:new Date,id:`save-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),V}async loadGame(V){try{const{state:j,config:tt}=await this.stateManager.loadGame(V);return this.currentState=j,this.currentConfig=tt,this.stateSynchronizer.forceState(j),this.sceneManager.setGameState(this.currentState),this.publishEvent({type:""game.save.loaded"",source:""game-engine-adapter"",data:{saveId:V,state:this.currentState},timestamp:new Date,id:`load-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),this.currentState}catch(j){throw this.publishEvent({type:""game.save.load_failed"",source:""game-engine-adapter"",data:{saveId:V,error:j.message},timestamp:new Date,id:`load-error-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),j}}async handleInput(V){this.gameStatistics.totalMoves++;const j=Date.now()-V.timestamp.getTime();this.gameStatistics.averageReactionTime=(this.gameStatistics.averageReactionTime+j)/2;const tt=this.sceneManager.getCurrentScene();tt&&""handleInput""in tt&&tt.handleInput(V),this.publishEvent({type:""game.input.received"",source:""game-engine-adapter"",data:{input:V},timestamp:new Date,id:`input-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""})}getCurrentState(){const V=this.sceneManager.getGameState();return V&&(this.currentState={...this.currentState,...V}),{...this.currentState}}onGameEvent(V){this.eventCallbacks.add(V)}offGameEvent(V){this.eventCallbacks.delete(V)}async endGame(){this.gameLoop.stop();const V=this.gameStartTime>0?Date.now()-this.gameStartTime:0,j={finalScore:this.currentState.score,levelReached:this.currentState.level,playTime:V,achievements:[],statistics:this.gameStatistics};return this.publishEvent({type:""game.session.ended"",source:""game-engine-adapter"",data:{result:j},timestamp:new Date,id:`end-${Date.now()}`,specversion:""1.0"",datacontenttype:""application/json""}),j}setContainer(V){this.container=V}getStateMachineState(){return this.stateMachine.current}async updateGame(V){this.currentState.timestamp=new Date;const j=this.sceneManager.getGameState();if(j){const tt=this.currentState.position,nt=j.position;if(tt&&nt){const dt=Math.sqrt(Math.pow(nt.x-tt.x,2)+Math.pow(nt.y-tt.y,2));this.gameStatistics.distanceTraveled+=dt}this.currentState={...this.currentState,...j}}}handleDomainEvent(V){this.eventCallbacks.forEach(j=>{try{j(V)}catch(tt){console.error(""Error in event callback:"",tt)}})}publishEvent(V){this.handleDomainEvent(V)}publishGameEvent(V){Hn.publish(V,{source:""phaser-engine"",priority:Mi.NORMAL})}setupEventBusListeners(){const V=Hn.subscribe(""react.command.pause"",async g=>{console.log(""Received pause command from React:"",g),await this.pauseGame(),this.publishGameEvent({type:""phaser.response.completed"",data:{command:""pause"",timestamp:new Date}})},{context:""phaser-adapter"",priority:Mi.HIGH}),j=Hn.subscribe(""react.command.resume"",async g=>{console.log(""Received resume command from React:"",g),await this.resumeGame(),this.publishGameEvent({type:""phaser.response.completed"",data:{command:""resume"",timestamp:new Date}})},{context:""phaser-adapter"",priority:Mi.HIGH}),tt=Hn.subscribe(""react.command.save"",async g=>{console.log(""Received save command from React:"",g);try{const A=await this.saveGame();this.publishGameEvent({type:""phaser.response.completed"",data:{command:""save"",result:{saveId:A},timestamp:new Date}})}catch(A){this.publishGameEvent({type:""game.error"",data:{error:A.message,context:""save-command"",timestamp:new Date}})}},{context:""phaser-adapter"",priority:Mi.HIGH}),nt=Hn.subscribe(""react.command.load"",async g=>{console.log(""Received load command from React:"",g);try{const A=g.data.saveId,t=await this.loadGame(A);this.publishGameEvent({type:""phaser.response.completed"",data:{command:""load"",result:{gameState:t},timestamp:new Date}})}catch(A){this.publishGameEvent({type:""game.error"",data:{error:A.message,context:""load-command"",timestamp:new Date}})}},{context:""phaser-adapter"",priority:Mi.HIGH}),dt=Hn.subscribe(""react.command.restart"",async g=>{console.log(""Received restart command from React:"",g);try{if(await this.endGame(),this.currentConfig){const A=await this.initializeGame(this.currentConfig);await this.startGame(),this.publishGameEvent({type:""phaser.response.completed"",data:{command:""restart"",result:{gameState:A},timestamp:new Date}})}}catch(A){this.publishGameEvent({type:""game.error"",data:{error:A.message,context:""restart-command"",timestamp:new Date}})}},{context:""phaser-adapter"",priority:Mi.HIGH});this.eventBusSubscriptions.push(V,j,tt,nt,dt),this.publishGameEvent({type:""phaser.response.ready"",data:{timestamp:new Date}})}publishDomainEventToEventBus(V){let j=null;switch(V.type){case""game.state.manager.updated"":j={type:""game.state.updated"",data:{gameState:V.data.state,timestamp:new Date}};break;case""game.save.created"":j={type:""game.save.created"",data:{saveId:V.data.saveId,gameState:V.data.state}};break;case""game.save.loaded"":j={type:""game.save.loaded"",data:{saveId:V.data.saveId,gameState:V.data.state}};break;case""game.autosave.completed"":j={type:""game.autosave.completed"",data:{saveId:V.data.saveId,timestamp:new Date}};break}j&&Hn.publish(j,{source:""phaser-adapter"",priority:Mi.NORMAL})}destroy(){this.eventBusSubscriptions.forEach(V=>{Hn.unsubscribe(V)}),this.eventBusSubscriptions=[],this.gameLoop.stop(),this.sceneManager.destroy(),this.stateManager.destroy(),this.stateSynchronizer.destroy(),this.eventCallbacks.clear()}}function AE({width:st=800,height:V=600,className:j="""",onGameEvent:tt,onGameStateChange:nt,autoStart:dt=!0}){const g=Yt.useRef(null),A=Yt.useRef(null),[t,c]=Yt.useState(null),[m,o]=Yt.useState(!1),[s,r]=Yt.useState(null),e=TE({context:""game-canvas"",enableAutoCleanup:!0}),n=Yt.useCallback(d=>{if(console.log(""Game Event:"",d),d.type===""game.state.updated""||d.type===""game.state.changed""){const{gameState:f}=d.data;c(f),nt?.(f)}d.type===""game.error""&&r(d.data.error),tt?.(d)},[tt,nt]);Yt.useEffect(()=>A.current?((async()=>{try{o(!0),r(null);const f=new CE;g.current=f,f.setContainer(A.current),f.onGameEvent(n);const p={maxLevel:50,initialHealth:100,scoreMultiplier:1,autoSave:!0,difficulty:""medium""},x=await f.initializeGame(p);c(x),dt&&await f.startGame(),o(!1)}catch(f){console.error(""Failed to initialize game:"",f),r(f.message),o(!1)}})(),()=>{g.current&&(g.current.destroy(),g.current=null)}):void 0,[st,V,dt,n]),Yt.useEffect(()=>{const d=e.onGameStateChange(f=>{console.log(""Game state changed via EventBus:"",f),c(f.data.gameState),nt?.(f.data.gameState)});return()=>{d.forEach(f=>e.unsubscribe(f))}},[e,nt]),Yt.useEffect(()=>{const d=e.onGameError(f=>{console.error(""Game error via EventBus:"",f),r(f.data.error)});return()=>{d.forEach(f=>e.unsubscribe(f))}},[e]),Yt.useEffect(()=>{const d=e.onPhaserResponse(f=>{console.log(""Phaser response:"",f),f.type===""phaser.response.ready""&&console.log(""Phaser engine is ready"")});return()=>{d.forEach(f=>e.unsubscribe(f))}},[e]);const h=Yt.useCallback(()=>{e.sendCommandToPhaser(""pause"")},[e]),i=Yt.useCallback(()=>{e.sendCommandToPhaser(""resume"")},[e]),l=Yt.useCallback(()=>{e.sendCommandToPhaser(""save"")},[e]);Yt.useCallback(d=>{e.sendCommandToPhaser(""load"",{saveId:d})},[e]);const u=Yt.useCallback(()=>{e.sendCommandToPhaser(""restart"")},[e]);return m?Ce.jsxDEV(""div"",{className:`game-canvas loading ${j}`,style:{width:st,height:V,display:""flex"",justifyContent:""center"",alignItems:""center"",border:""2px solid #3182ce"",borderRadius:""8px"",backgroundColor:""#1a202c""},children:Ce.jsxDEV(""div"",{style:{color:""#ffffff"",fontSize:""18px""},children:""正在加载游戏引擎...""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:202,columnNumber:9},this)},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:189,columnNumber:7},this):s?Ce.jsxDEV(""div"",{className:`game-canvas error ${j}`,style:{width:st,height:V,display:""flex"",flexDirection:""column"",justifyContent:""center"",alignItems:""center"",border:""2px solid #ef4444"",borderRadius:""8px"",backgroundColor:""#1a202c"",padding:""20px""},children:[Ce.jsxDEV(""div"",{style:{color:""#ef4444"",fontSize:""18px"",marginBottom:""10px""},children:""游戏引擎初始化失败""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:227,columnNumber:9},this),Ce.jsxDEV(""div"",{style:{color:""#94a3b8"",fontSize:""14px"",textAlign:""center""},children:s},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:232,columnNumber:9},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:212,columnNumber:7},this):Ce.jsxDEV(""div"",{className:`game-canvas ${j}`,style:{position:""relative"",border:""2px solid #3182ce"",borderRadius:""8px"",padding:""10px"",backgroundColor:""#1a202c""},children:[Ce.jsxDEV(""div"",{ref:A,style:{width:st,height:V,display:""flex"",justifyContent:""center"",alignItems:""center""}},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:252,columnNumber:7},this),t&&Ce.jsxDEV(""div"",{style:{position:""absolute"",top:""20px"",right:""20px"",backgroundColor:""rgba(0, 0, 0, 0.8)"",color:""#ffffff"",padding:""10px"",borderRadius:""5px"",fontSize:""12px"",minWidth:""150px""},children:[Ce.jsxDEV(""div"",{children:[""分数: "",t.score]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:278,columnNumber:11},this),Ce.jsxDEV(""div"",{children:[""等级: "",t.level]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:279,columnNumber:11},this),Ce.jsxDEV(""div"",{children:[""生命值: "",t.health]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:280,columnNumber:11},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:265,columnNumber:9},this),Ce.jsxDEV(""div"",{style:{position:""absolute"",bottom:""20px"",left:""20px"",display:""flex"",gap:""10px""},children:[Ce.jsxDEV(""button"",{onClick:h,style:{padding:""5px 10px"",backgroundColor:""#3182ce"",color:""#ffffff"",border:""none"",borderRadius:""3px"",cursor:""pointer"",fontSize:""12px""},children:""暂停""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:294,columnNumber:9},this),Ce.jsxDEV(""button"",{onClick:i,style:{padding:""5px 10px"",backgroundColor:""#059669"",color:""#ffffff"",border:""none"",borderRadius:""3px"",cursor:""pointer"",fontSize:""12px""},children:""继续""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:308,columnNumber:9},this),Ce.jsxDEV(""button"",{onClick:l,style:{padding:""5px 10px"",backgroundColor:""#dc2626"",color:""#ffffff"",border:""none"",borderRadius:""3px"",cursor:""pointer"",fontSize:""12px""},children:""保存""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:322,columnNumber:9},this),Ce.jsxDEV(""button"",{onClick:u,style:{padding:""5px 10px"",backgroundColor:""#f59e0b"",color:""#ffffff"",border:""none"",borderRadius:""3px"",cursor:""pointer"",fontSize:""12px""},children:""重启""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:336,columnNumber:9},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:285,columnNumber:7},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/components/GameCanvas.tsx"",lineNumber:242,columnNumber:5},this)}let yy=-1;const oa=st=>{addEventListener(""pageshow"",V=>{V.persisted&&(yy=V.timeStamp,st(V))},!0)},mn=(st,V,j,tt)=>{let nt,dt;return g=>{V.value>=0&&(g||tt)&&(dt=V.value-(nt??0),(dt||nt===void 0)&&(nt=V.value,V.delta=dt,V.rating=((A,t)=>A>t[1]?""poor"":A>t[0]?""needs-improvement"":""good"")(V.value,j),st(V)))}},Ac=st=>{requestAnimationFrame(()=>requestAnimationFrame(()=>st()))},Rc=()=>{const st=performance.getEntriesByType(""navigation"")[0];if(st&&st.responseStart>0&&st.responseStart<performance.now())return st},Go=()=>Rc()?.activationStart??0,gn=(st,V=-1)=>{const j=Rc();let tt=""navigate"";return yy>=0?tt=""back-forward-cache"":j&&(document.prerendering||Go()>0?tt=""prerender"":document.wasDiscarded?tt=""restore"":j.type&&(tt=j.type.replace(/_/g,""-""))),{name:st,value:V,rating:""good"",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:tt}},mc=new WeakMap;function Mc(st,V){return mc.get(st)||mc.set(st,new V),mc.get(st)}class RE{t;i=0;o=[];h(V){if(V.hadRecentInput)return;const j=this.o[0],tt=this.o.at(-1);this.i&&j&&tt&&V.startTime-tt.startTime<1e3&&V.startTime-j.startTime<5e3?(this.i+=V.value,this.o.push(V)):(this.i=V.value,this.o=[V]),this.t?.(V)}}const No=(st,V,j={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(st)){const tt=new PerformanceObserver(nt=>{Promise.resolve().then(()=>{V(nt.getEntries())})});return tt.observe({type:st,buffered:!0,...j}),tt}}catch{}},Pc=st=>{let V=!1;return()=>{V||(st(),V=!0)}};let sa=-1;const Ty=new Set,iy=()=>document.visibilityState!==""hidden""||document.prerendering?1/0:0,Tc=st=>{if(document.visibilityState===""hidden""){if(st.type===""visibilitychange"")for(const V of Ty)V();isFinite(sa)||(sa=st.type===""visibilitychange""?st.timeStamp:0,removeEventListener(""prerenderingchange"",Tc,!0))}},Nh=()=>{if(sa<0){const st=Go();sa=(document.prerendering?void 0:globalThis.performance.getEntriesByType(""visibility-state"").filter(j=>j.name===""hidden""&&j.startTime>st)[0]?.startTime)??iy(),addEventListener(""visibilitychange"",Tc,!0),addEventListener(""prerenderingchange"",Tc,!0),oa(()=>{setTimeout(()=>{sa=iy()})})}return{get firstHiddenTime(){return sa},onHidden(st){Ty.add(st)}}},Ih=st=>{document.prerendering?addEventListener(""prerenderingchange"",()=>st(),!0):st()},ny=[1800,3e3],Sy=(st,V={})=>{Ih(()=>{const j=Nh();let tt,nt=gn(""FCP"");const dt=No(""paint"",g=>{for(const A of g)A.name===""first-contentful-paint""&&(dt.disconnect(),A.startTime<j.firstHiddenTime&&(nt.value=Math.max(A.startTime-Go(),0),nt.entries.push(A),tt(!0)))});dt&&(tt=mn(st,nt,ny,V.reportAllChanges),oa(g=>{nt=gn(""FCP""),tt=mn(st,nt,ny,V.reportAllChanges),Ac(()=>{nt.value=performance.now()-g.timeStamp,tt(!0)})}))})},sy=[.1,.25],ME=(st,V={})=>{const j=Nh();Sy(Pc(()=>{let tt,nt=gn(""CLS"",0);const dt=Mc(V,RE),g=t=>{for(const c of t)dt.h(c);dt.i>nt.value&&(nt.value=dt.i,nt.entries=dt.o,tt())},A=No(""layout-shift"",g);A&&(tt=mn(st,nt,sy,V.reportAllChanges),j.onHidden(()=>{g(A.takeRecords()),tt(!0)}),oa(()=>{dt.i=0,nt=gn(""CLS"",0),tt=mn(st,nt,sy,V.reportAllChanges),Ac(()=>tt())}),setTimeout(tt))}))};let Ey=0,gc=1/0,Fh=0;const PE=st=>{for(const V of st)V.interactionId&&(gc=Math.min(gc,V.interactionId),Fh=Math.max(Fh,V.interactionId),Ey=Fh?(Fh-gc)/7+1:0)};let Sc;const ry=()=>Sc?Ey:performance.interactionCount??0,LE=()=>{""interactionCount""in performance||Sc||(Sc=No(""event"",PE,{type:""event"",buffered:!0,durationThreshold:0}))};let ay=0;class OE{u=[];l=new Map;m;p;v(){ay=ry(),this.u.length=0,this.l.clear()}L(){const V=Math.min(this.u.length-1,Math.floor((ry()-ay)/50));return this.u[V]}h(V){if(this.m?.(V),!V.interactionId&&V.entryType!==""first-input"")return;const j=this.u.at(-1);let tt=this.l.get(V.interactionId);if(tt||this.u.length<10||V.duration>j.P){if(tt?V.duration>tt.P?(tt.entries=[V],tt.P=V.duration):V.duration===tt.P&&V.startTime===tt.entries[0].startTime&&tt.entries.push(V):(tt={id:V.interactionId,entries:[V],P:V.duration},this.l.set(tt.id,tt),this.u.push(tt)),this.u.sort((nt,dt)=>dt.P-nt.P),this.u.length>10){const nt=this.u.splice(10);for(const dt of nt)this.l.delete(dt.id)}this.p?.(tt)}}}const Cy=st=>{const V=globalThis.requestIdleCallback||setTimeout;document.visibilityState===""hidden""?st():(st=Pc(st),addEventListener(""visibilitychange"",st,{once:!0,capture:!0}),V(()=>{st(),removeEventListener(""visibilitychange"",st,{capture:!0})}))},oy=[200,500],DE=(st,V={})=>{if(!globalThis.PerformanceEventTiming||!(""interactionId""in PerformanceEventTiming.prototype))return;const j=Nh();Ih(()=>{LE();let tt,nt=gn(""INP"");const dt=Mc(V,OE),g=t=>{Cy(()=>{for(const m of t)dt.h(m);const c=dt.L();c&&c.P!==nt.value&&(nt.value=c.P,nt.entries=c.entries,tt())})},A=No(""event"",g,{durationThreshold:V.durationThreshold??40});tt=mn(st,nt,oy,V.reportAllChanges),A&&(A.observe({type:""first-input"",buffered:!0}),j.onHidden(()=>{g(A.takeRecords()),tt(!0)}),oa(()=>{dt.v(),nt=gn(""INP""),tt=mn(st,nt,oy,V.reportAllChanges)}))})};class wE{m;h(V){this.m?.(V)}}const ly=[2500,4e3],FE=(st,V={})=>{Ih(()=>{const j=Nh();let tt,nt=gn(""LCP"");const dt=Mc(V,wE),g=t=>{V.reportAllChanges||(t=t.slice(-1));for(const c of t)dt.h(c),c.startTime<j.firstHiddenTime&&(nt.value=Math.max(c.startTime-Go(),0),nt.entries=[c],tt())},A=No(""largest-contentful-paint"",g);if(A){tt=mn(st,nt,ly,V.reportAllChanges);const t=Pc(()=>{g(A.takeRecords()),A.disconnect(),tt(!0)}),c=m=>{m.isTrusted&&(Cy(t),removeEventListener(m.type,c,{capture:!0}))};for(const m of[""keydown"",""click"",""visibilitychange""])addEventListener(m,c,{capture:!0});oa(m=>{nt=gn(""LCP""),tt=mn(st,nt,ly,V.reportAllChanges),Ac(()=>{nt.value=performance.now()-m.timeStamp,tt(!0)})})}})},hy=[800,1800],Ec=st=>{document.prerendering?Ih(()=>Ec(st)):document.readyState!==""complete""?addEventListener(""load"",()=>Ec(st),!0):setTimeout(st)},bE=(st,V={})=>{let j=gn(""TTFB""),tt=mn(st,j,hy,V.reportAllChanges);Ec(()=>{const nt=Rc();nt&&(j.value=Math.max(nt.responseStart-Go(),0),j.entries=[nt],tt(!0),oa(()=>{j=gn(""TTFB"",0),tt=mn(st,j,hy,V.reportAllChanges),tt(!0)}))})},BE={LCP:{good:2500,needs_improvement:4e3},INP:{good:200,needs_improvement:500},CLS:{good:.1,needs_improvement:.25},FCP:{good:1800,needs_improvement:3e3},TTFB:{good:800,needs_improvement:1800}};class GE{constructor(){this.metrics={customTimings:{}},this.callbacks=[],this.isInitialized=!1,this.userTimings=[],this.PERFORMANCE_TARGETS={interaction_p95:100,event_p95:50,route_change_p95:200,data_fetch_p95:300},this.initializeWebVitals(),this.setupCustomPerformanceObserver()}initializeWebVitals(){if(!(this.isInitialized||typeof window>""u""))try{ME(this.onCLS.bind(this),{reportAllChanges:!0}),Sy(this.onFCP.bind(this)),DE(this.onINP.bind(this)),FE(this.onLCP.bind(this),{reportAllChanges:!0}),bE(this.onTTFB.bind(this)),this.initializeINP(),this.isInitialized=!0,console.log(""[WebVitals] 监控系统初始化完成"")}catch(V){console.error(""[WebVitals] 初始化失败:"",V)}}initializeINP(){""PerformanceEventTiming""in window&&new PerformanceObserver(j=>{const tt=j.getEntries();for(const nt of tt)if(nt.processingStart&&nt.processingEnd){const dt=nt.processingEnd-nt.startTime;if(dt>0){const g=this.getRating(""INP"",dt),A={id:`inp-${Date.now()}`,name:""INP"",value:dt,delta:dt,rating:g,entries:[nt],timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()};this.metrics.inp=A,this.notifyCallbacks()}}}).observe({entryTypes:[""event""]})}setupCustomPerformanceObserver(){""PerformanceObserver""in window&&new PerformanceObserver(j=>{const tt=j.getEntries();for(const nt of tt)nt.entryType===""mark""?this.userTimings.push({name:nt.name,startTime:nt.startTime,type:""mark""}):nt.entryType===""measure""&&(this.userTimings.push({name:nt.name,startTime:nt.startTime,duration:nt.duration,type:""measure""}),this.metrics.customTimings[nt.name]=nt.duration)}).observe({entryTypes:[""mark"",""measure""]})}onCLS(V){const j=this.getRating(""CLS"",V.value);this.metrics.cls={...V,rating:j,timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()},this.notifyCallbacks()}onFCP(V){const j=this.getRating(""FCP"",V.value);this.metrics.fcp={...V,rating:j,timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()},this.notifyCallbacks()}onLCP(V){const j=this.getRating(""LCP"",V.value);this.metrics.lcp={...V,rating:j,timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()},this.notifyCallbacks()}onTTFB(V){const j=this.getRating(""TTFB"",V.value);this.metrics.ttfb={...V,rating:j,timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()},this.notifyCallbacks()}onINP(V){const j=this.getRating(""INP"",V.value);this.metrics.inp={...V,rating:j,timestamp:Date.now(),navigationType:this.getNavigationType(),connection:this.getConnectionInfo()},this.notifyCallbacks()}getRating(V,j){const tt=BE[V];return j<=tt.good?""good"":j<=tt.needs_improvement?""needs-improvement"":""poor""}getNavigationType(){return""navigation""in performance&&""type""in performance.navigation&&[""navigate"",""reload"",""back_forward"",""prerender""][performance.navigation.type]||""unknown""}getConnectionInfo(){if(""connection""in navigator&&navigator.connection){const V=navigator.connection;return{effectiveType:V.effectiveType,downlink:V.downlink,rtt:V.rtt}}}notifyCallbacks(){this.callbacks.forEach(V=>{try{V(this.metrics)}catch(j){console.error(""[WebVitals] 回调函数执行错误:"",j)}})}subscribe(V){return this.callbacks.push(V),Object.keys(this.metrics).length>1&&V(this.metrics),()=>{const j=this.callbacks.indexOf(V);j>-1&&this.callbacks.splice(j,1)}}getMetrics(){return{...this.metrics}}mark(V){""performance""in window&&""mark""in performance&&performance.mark(V)}measure(V,j,tt){""performance""in window&&""measure""in performance&&(j&&tt?performance.measure(V,j,tt):j?performance.measure(V,j):performance.measure(V))}recordInteraction(V,j){this.metrics.customTimings[`interaction_${V}`]=j,j>this.PERFORMANCE_TARGETS.interaction_p95&&console.warn(`[WebVitals] 交互""${V}""耗时${j}ms，超出P95目标${this.PERFORMANCE_TARGETS.interaction_p95}ms`)}recordEvent(V,j){this.metrics.customTimings[`event_${V}`]=j,j>this.PERFORMANCE_TARGETS.event_p95&&console.warn(`[WebVitals] 事件""${V}""处理耗时${j}ms，超出P95目标${this.PERFORMANCE_TARGETS.event_p95}ms`)}recordRouteChange(V,j,tt){const nt=`route_${V}_to_${j}`;this.metrics.customTimings[nt]=tt,tt>this.PERFORMANCE_TARGETS.route_change_p95&&console.warn(`[WebVitals] 路由切换""${V} → ${j}""耗时${tt}ms，超出P95目标${this.PERFORMANCE_TARGETS.route_change_p95}ms`)}recordDataFetch(V,j){this.metrics.customTimings[`fetch_${V}`]=j,j>this.PERFORMANCE_TARGETS.data_fetch_p95&&console.warn(`[WebVitals] 数据获取""${V}""耗时${j}ms，超出P95目标${this.PERFORMANCE_TARGETS.data_fetch_p95}ms`)}getPerformanceSummary(){const{lcp:V,inp:j,cls:tt,fcp:nt,ttfb:dt}=this.metrics;return{coreVitals:{lcp:V?{value:V.value,rating:V.rating}:null,inp:j?{value:j.value,rating:j.rating}:null,cls:tt?{value:tt.value,rating:tt.rating}:null},otherMetrics:{fcp:nt?{value:nt.value,rating:nt.rating}:null,ttfb:dt?{value:dt.value,rating:dt.rating}:null},customTimings:{...this.metrics.customTimings},userTimings:[...this.userTimings],timestamp:Date.now()}}reset(){this.metrics={customTimings:{}},this.userTimings=[],console.log(""[WebVitals] 性能指标已重置"")}destroy(){this.callbacks=[],this.reset(),console.log(""[WebVitals] 监控器已销毁"")}}let xc=null;const Ay=()=>(xc||(xc=new GE),xc),ra=typeof __SENTRY_DEBUG__>""u""||__SENTRY_DEBUG__,Ts=globalThis,bo=""10.5.0"";function Lc(){return Oc(Ts),Ts}function Oc(st){const V=st.__SENTRY__=st.__SENTRY__||{};return V.version=V.version||bo,V[bo]=V[bo]||{}}function Dc(st,V,j=Ts){const tt=j.__SENTRY__=j.__SENTRY__||{},nt=tt[bo]=tt[bo]||{};return nt[st]||(nt[st]=V())}const NE=""Sentry Logger "",uy={};function Ry(st){if(!(""console""in Ts))return st();const V=Ts.console,j={},tt=Object.keys(uy);tt.forEach(nt=>{const dt=uy[nt];j[nt]=V[nt],V[nt]=dt});try{return st()}finally{tt.forEach(nt=>{V[nt]=j[nt]})}}function IE(){Fc().enabled=!0}function zE(){Fc().enabled=!1}function My(){return Fc().enabled}function UE(...st){wc(""log"",...st)}function VE(...st){wc(""warn"",...st)}function XE(...st){wc(""error"",...st)}function wc(st,...V){ra&&My()&&Ry(()=>{Ts.console[st](`${NE}[${st}]:`,...V)})}function Fc(){return ra?Dc(""loggerSettings"",()=>({enabled:!1})):{enabled:!1}}const Bh={enable:IE,disable:zE,isEnabled:My,log:UE,warn:VE,error:XE},YE=Object.prototype.toString;function HE(st,V){return YE.call(st)===`[object ${V}]`}function WE(st){return HE(st,""Object"")}function ZE(st){return!!(st?.then&&typeof st.then==""function"")}function QE(st,V=0){return typeof st!=""string""||V===0||st.length<=V?st:`${st.slice(0,V)}...`}function KE(st,V,j){try{Object.defineProperty(st,V,{value:j,writable:!0,configurable:!0})}catch{ra&&Bh.log(`Failed to add non-enumerable property ""${V}"" to object`,st)}}function JE(){const st=Ts;return st.crypto||st.msCrypto}function Bo(st=JE()){let V=()=>Math.random()*16;try{if(st?.randomUUID)return st.randomUUID().replace(/-/g,"""");st?.getRandomValues&&(V=()=>{const j=new Uint8Array(1);return st.getRandomValues(j),j[0]})}catch{}return(""10000000100040008000""+1e11).replace(/[018]/g,j=>(j^(V()&15)>>j/4).toString(16))}const Py=1e3;function bc(){return Date.now()/Py}function $E(){const{performance:st}=Ts;if(!st?.now||!st.timeOrigin)return bc;const V=st.timeOrigin;return()=>(V+st.now())/Py}let fy;function jE(){return(fy??(fy=$E()))()}function kE(st,V={}){if(V.user&&(!st.ipAddress&&V.user.ip_address&&(st.ipAddress=V.user.ip_address),!st.did&&!V.did&&(st.did=V.user.id||V.user.email||V.user.username)),st.timestamp=V.timestamp||jE(),V.abnormal_mechanism&&(st.abnormal_mechanism=V.abnormal_mechanism),V.ignoreDuration&&(st.ignoreDuration=V.ignoreDuration),V.sid&&(st.sid=V.sid.length===32?V.sid:Bo()),V.init!==void 0&&(st.init=V.init),!st.did&&V.did&&(st.did=`${V.did}`),typeof V.started==""number""&&(st.started=V.started),st.ignoreDuration)st.duration=void 0;else if(typeof V.duration==""number"")st.duration=V.duration;else{const j=st.timestamp-st.started;st.duration=j>=0?j:0}V.release&&(st.release=V.release),V.environment&&(st.environment=V.environment),!st.ipAddress&&V.ipAddress&&(st.ipAddress=V.ipAddress),!st.userAgent&&V.userAgent&&(st.userAgent=V.userAgent),typeof V.errors==""number""&&(st.errors=V.errors),V.status&&(st.status=V.status)}function Ly(st,V,j=2){if(!V||typeof V!=""object""||j<=0)return V;if(st&&Object.keys(V).length===0)return st;const tt={...st};for(const nt in V)Object.prototype.hasOwnProperty.call(V,nt)&&(tt[nt]=Ly(tt[nt],V[nt],j-1));return tt}function dy(){return Bo()}const Cc=""_sentrySpan"";function cy(st,V){V?KE(st,Cc,V):delete st[Cc]}function vy(st){return st[Cc]}const qE=100;class nr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:dy(),sampleRand:Math.random()}}clone(){const V=new nr;return V._breadcrumbs=[...this._breadcrumbs],V._tags={...this._tags},V._extra={...this._extra},V._contexts={...this._contexts},this._contexts.flags&&(V._contexts.flags={values:[...this._contexts.flags.values]}),V._user=this._user,V._level=this._level,V._session=this._session,V._transactionName=this._transactionName,V._fingerprint=this._fingerprint,V._eventProcessors=[...this._eventProcessors],V._attachments=[...this._attachments],V._sdkProcessingMetadata={...this._sdkProcessingMetadata},V._propagationContext={...this._propagationContext},V._client=this._client,V._lastEventId=this._lastEventId,cy(V,vy(this)),V}setClient(V){this._client=V}setLastEventId(V){this._lastEventId=V}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(V){this._scopeListeners.push(V)}addEventProcessor(V){return this._eventProcessors.push(V),this}setUser(V){return this._user=V||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&kE(this._session,{user:V}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(V){return this._tags={...this._tags,...V},this._notifyScopeListeners(),this}setTag(V,j){return this._tags={...this._tags,[V]:j},this._notifyScopeListeners(),this}setExtras(V){return this._extra={...this._extra,...V},this._notifyScopeListeners(),this}setExtra(V,j){return this._extra={...this._extra,[V]:j},this._notifyScopeListeners(),this}setFingerprint(V){return this._fingerprint=V,this._notifyScopeListeners(),this}setLevel(V){return this._level=V,this._notifyScopeListeners(),this}setTransactionName(V){return this._transactionName=V,this._notifyScopeListeners(),this}setContext(V,j){return j===null?delete this._contexts[V]:this._contexts[V]=j,this._notifyScopeListeners(),this}setSession(V){return V?this._session=V:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(V){if(!V)return this;const j=typeof V==""function""?V(this):V,tt=j instanceof nr?j.getScopeData():WE(j)?V:void 0,{tags:nt,extra:dt,user:g,contexts:A,level:t,fingerprint:c=[],propagationContext:m}=tt||{};return this._tags={...this._tags,...nt},this._extra={...this._extra,...dt},this._contexts={...this._contexts,...A},g&&Object.keys(g).length&&(this._user=g),t&&(this._level=t),c.length&&(this._fingerprint=c),m&&(this._propagationContext=m),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,cy(this,void 0),this._attachments=[],this.setPropagationContext({traceId:dy(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(V,j){const tt=typeof j==""number""?j:qE;if(tt<=0)return this;const nt={timestamp:bc(),...V,message:V.message?QE(V.message,2048):V.message};return this._breadcrumbs.push(nt),this._breadcrumbs.length>tt&&(this._breadcrumbs=this._breadcrumbs.slice(-tt),this._client?.recordDroppedEvent(""buffer_overflow"",""log_item"")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(V){return this._attachments.push(V),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:vy(this)}}setSDKProcessingMetadata(V){return this._sdkProcessingMetadata=Ly(this._sdkProcessingMetadata,V,2),this}setPropagationContext(V){return this._propagationContext=V,this}getPropagationContext(){return this._propagationContext}captureException(V,j){const tt=j?.event_id||Bo();if(!this._client)return ra&&Bh.warn(""No client configured on scope - will not capture exception!""),tt;const nt=new Error(""Sentry syntheticException"");return this._client.captureException(V,{originalException:V,syntheticException:nt,...j,event_id:tt},this),tt}captureMessage(V,j,tt){const nt=tt?.event_id||Bo();if(!this._client)return ra&&Bh.warn(""No client configured on scope - will not capture message!""),nt;const dt=new Error(V);return this._client.captureMessage(V,j,{originalException:V,syntheticException:dt,...tt,event_id:nt},this),nt}captureEvent(V,j){const tt=j?.event_id||Bo();return this._client?(this._client.captureEvent(V,{...j,event_id:tt},this),tt):(ra&&Bh.warn(""No client configured on scope - will not capture event!""),tt)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(V=>{V(this)}),this._notifyingListeners=!1)}}function _E(){return Dc(""defaultCurrentScope"",()=>new nr)}function tC(){return Dc(""defaultIsolationScope"",()=>new nr)}class eC{constructor(V,j){let tt;V?tt=V:tt=new nr;let nt;j?nt=j:nt=new nr,this._stack=[{scope:tt}],this._isolationScope=nt}withScope(V){const j=this._pushScope();let tt;try{tt=V(j)}catch(nt){throw this._popScope(),nt}return ZE(tt)?tt.then(nt=>(this._popScope(),nt),nt=>{throw this._popScope(),nt}):(this._popScope(),tt)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const V=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:V}),V}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function aa(){const st=Lc(),V=Oc(st);return V.stack=V.stack||new eC(_E(),tC())}function iC(st){return aa().withScope(st)}function nC(st,V){const j=aa();return j.withScope(()=>(j.getStackTop().scope=st,V(st)))}function py(st){return aa().withScope(()=>st(aa().getIsolationScope()))}function sC(){return{withIsolationScope:py,withScope:iC,withSetScope:nC,withSetIsolationScope:(st,V)=>py(V),getCurrentScope:()=>aa().getScope(),getIsolationScope:()=>aa().getIsolationScope()}}function Oy(st){const V=Oc(st);return V.acs?V.acs:sC()}function Dy(){const st=Lc();return Oy(st).getCurrentScope()}function rC(){const st=Lc();return Oy(st).getIsolationScope()}function aC(){return Dy().getClient()}function my(st,V){const j=typeof V==""string""?V:void 0,tt=typeof V!=""string""?{captureContext:V}:void 0;return Dy().captureMessage(st,j,tt)}const oC=100;function gy(st,V){const j=aC(),tt=rC();if(!j)return;const{beforeBreadcrumb:nt=null,maxBreadcrumbs:dt=oC}=j.getOptions();if(dt<=0)return;const A={timestamp:bc(),...st},t=nt?Ry(()=>nt(A,V)):A;t!==null&&(j.emit&&j.emit(""beforeAddBreadcrumb"",t,V),tt.addBreadcrumb(t,dt))}class lC{constructor(V={}){this.dataBuffer=[],this.flushTimer=null,this.isEnabled=!1,this.monitor=Ay(),this.unsubscribe=null,this.DEFAULT_CONFIG={enabled:!0,sentryEnabled:!0,batchSize:10,flushInterval:3e4,storageKey:""web-vitals-data"",baselineWindow:7,regressionThreshold:15},this.config={...this.DEFAULT_CONFIG,...V},this.sessionId=this.generateSessionId(),this.config.enabled&&typeof window<""u""&&this.initialize()}initialize(){try{this.unsubscribe=this.monitor.subscribe(V=>{this.collectData(V)}),this.setupFlushTimer(),this.setupUnloadHandler(),this.cleanupOldData(),this.isEnabled=!0,console.log(""[WebVitalsCollector] 数据收集器初始化完成"")}catch(V){console.error(""[WebVitalsCollector] 初始化失败:"",V)}}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}collectData(V){if(!this.isEnabled)return;const j={timestamp:Date.now(),sessionId:this.sessionId,userId:this.getUserId(),metrics:V,context:this.collectContext()};this.dataBuffer.push(j),this.dataBuffer.length>=this.config.batchSize&&this.flush(),this.checkRegression(j)}collectContext(){const V={userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight},navigation:{type:""navigate"",redirectCount:0}};if(""connection""in navigator&&navigator.connection){const j=navigator.connection;V.connection={effectiveType:j.effectiveType,downlink:j.downlink,rtt:j.rtt}}if(""navigation""in performance){const j=performance.navigation;V.navigation={type:[""navigate"",""reload"",""back_forward"",""prerender""][j.type]||""navigate"",redirectCount:j.redirectCount}}if(""memory""in performance){const j=performance.memory;V.memory={usedJSHeapSize:j.usedJSHeapSize,totalJSHeapSize:j.totalJSHeapSize}}return V}getUserId(){try{const V=localStorage.getItem(""userId"")||localStorage.getItem(""user_id"")||sessionStorage.getItem(""userId"");if(V)return V;const j=document.cookie.match(/user_id=([^;]+)/);return j?j[1]:void 0}catch{return}}setupFlushTimer(){this.flushTimer&&clearInterval(this.flushTimer),this.flushTimer=setInterval(()=>{this.dataBuffer.length>0&&this.flush()},this.config.flushInterval)}setupUnloadHandler(){const V=()=>{this.dataBuffer.length>0&&this.flushSync()};window.addEventListener(""beforeunload"",V),window.addEventListener(""pagehide"",V)}flush(){if(this.dataBuffer.length===0)return;const V=[...this.dataBuffer];this.dataBuffer=[],Promise.all([this.sendToSentry(V),this.saveToLocalStorage(V),this.sendToCustomEndpoint(V)]).catch(j=>{console.error(""[WebVitalsCollector] 数据上报失败:"",j),this.dataBuffer.unshift(...V)})}flushSync(){if(this.dataBuffer.length===0)return;const V=JSON.stringify(this.dataBuffer);try{""sendBeacon""in navigator&&navigator.sendBeacon(""/api/web-vitals"",V),this.saveToLocalStorageSync(this.dataBuffer)}catch(j){console.error(""[WebVitalsCollector] 同步上报失败:"",j)}this.dataBuffer=[]}async sendToSentry(V){if(this.config.sentryEnabled)try{V.forEach(j=>{j.metrics.lcp&&this.sendMetricToSentry(""LCP"",j.metrics.lcp,j),j.metrics.inp&&this.sendMetricToSentry(""INP"",j.metrics.inp,j),j.metrics.cls&&this.sendMetricToSentry(""CLS"",j.metrics.cls,j),j.metrics.fcp&&this.sendMetricToSentry(""FCP"",j.metrics.fcp,j),j.metrics.ttfb&&this.sendMetricToSentry(""TTFB"",j.metrics.ttfb,j),Object.entries(j.metrics.customTimings).forEach(([tt,nt])=>{gy({category:""performance"",message:`Custom timing: ${tt}`,level:""info"",data:{value:nt,sessionId:j.sessionId}})})})}catch(j){throw console.error(""[WebVitalsCollector] Sentry上报失败:"",j),j}}sendMetricToSentry(V,j,tt){gy({category:""performance"",message:`Web Vital: ${V}`,level:j.rating===""good""?""info"":j.rating===""needs-improvement""?""warning"":""error"",data:{value:j.value,rating:j.rating,sessionId:tt.sessionId,connection:tt.context.connection,viewport:tt.context.viewport}}),j.rating===""poor""&&my(`Poor ${V}: ${j.value}`,{level:""warning"",tags:{webVital:V,rating:j.rating},extra:{metric:j,context:tt.context}})}async sendToCustomEndpoint(V){try{await fetch(""/api/web-vitals"",{method:""POST"",headers:{""Content-Type"":""application/json""},body:JSON.stringify(V)})}catch(j){console.warn(""[WebVitalsCollector] 自定义端点上报失败:"",j)}}saveToLocalStorage(V){try{const nt=[...this.getStoredData(),...V].slice(-1e3);localStorage.setItem(this.config.storageKey,JSON.stringify(nt))}catch(j){console.error(""[WebVitalsCollector] 本地存储失败:"",j)}}saveToLocalStorageSync(V){try{const nt=[...this.getStoredData(),...V].slice(-1e3);localStorage.setItem(this.config.storageKey,JSON.stringify(nt))}catch(j){console.error(""[WebVitalsCollector] 同步本地存储失败:"",j)}}getStoredData(){try{const V=localStorage.getItem(this.config.storageKey);return V?JSON.parse(V):[]}catch{return[]}}cleanupOldData(){try{const V=this.getStoredData(),j=Date.now()-this.config.baselineWindow*24*60*60*1e3,tt=V.filter(nt=>nt.timestamp>j);tt.length!==V.length&&(localStorage.setItem(this.config.storageKey,JSON.stringify(tt)),console.log(`[WebVitalsCollector] 清理了${V.length-tt.length}条旧数据`))}catch(V){console.error(""[WebVitalsCollector] 数据清理失败:"",V)}}checkRegression(V){try{const j=this.getBaseline();if(!j)return;const tt=[];if(V.metrics.lcp&&j.lcp_p95){const nt=this.calculateRegression(V.metrics.lcp.value,j.lcp_p95);nt>this.config.regressionThreshold&&tt.push({metric:""LCP"",currentValue:V.metrics.lcp.value,baselineValue:j.lcp_p95,regressionPercentage:nt,severity:nt>30?""critical"":""warning"",timestamp:Date.now()})}if(V.metrics.inp&&j.inp_p95){const nt=this.calculateRegression(V.metrics.inp.value,j.inp_p95);nt>this.config.regressionThreshold&&tt.push({metric:""INP"",currentValue:V.metrics.inp.value,baselineValue:j.inp_p95,regressionPercentage:nt,severity:nt>30?""critical"":""warning"",timestamp:Date.now()})}if(V.metrics.cls&&j.cls_p95){const nt=this.calculateRegression(V.metrics.cls.value,j.cls_p95);nt>this.config.regressionThreshold&&tt.push({metric:""CLS"",currentValue:V.metrics.cls.value,baselineValue:j.cls_p95,regressionPercentage:nt,severity:nt>50?""critical"":""warning"",timestamp:Date.now()})}tt.length>0&&this.reportRegressions(tt)}catch(j){console.error(""[WebVitalsCollector] 回归检测失败:"",j)}}calculateRegression(V,j){return(V-j)/j*100}reportRegressions(V){V.forEach(j=>{console.warn(`[WebVitalsCollector] ${j.metric}性能回归检测:`,j),this.config.sentryEnabled&&my(`Web Vitals回归: ${j.metric}`,{level:j.severity===""critical""?""error"":""warning"",tags:{regression:!0,metric:j.metric,severity:j.severity},extra:j})})}getBaseline(){try{const V=localStorage.getItem(`${this.config.storageKey}-baseline`);return V?JSON.parse(V):null}catch{return null}}updateBaseline(){try{const V=this.getStoredData(),j=Date.now()-this.config.baselineWindow*24*60*60*1e3,tt=V.filter(m=>m.timestamp>j);if(tt.length<10)return console.warn(""[WebVitalsCollector] 数据量不足，无法计算基线""),null;const nt=tt.filter(m=>m.metrics.lcp).map(m=>m.metrics.lcp.value),dt=tt.filter(m=>m.metrics.inp).map(m=>m.metrics.inp.value),g=tt.filter(m=>m.metrics.cls).map(m=>m.metrics.cls.value),A=tt.filter(m=>m.metrics.fcp).map(m=>m.metrics.fcp.value),t=tt.filter(m=>m.metrics.ttfb).map(m=>m.metrics.ttfb.value),c={lcp_p95:this.calculateP95(nt),inp_p95:this.calculateP95(dt),cls_p95:this.calculateP95(g),fcp_p95:this.calculateP95(A),ttfb_p95:this.calculateP95(t),sampleSize:tt.length,windowStart:j,windowEnd:Date.now(),lastUpdated:Date.now()};return localStorage.setItem(`${this.config.storageKey}-baseline`,JSON.stringify(c)),console.log(""[WebVitalsCollector] 性能基线已更新:"",c),c}catch(V){return console.error(""[WebVitalsCollector] 基线计算失败:"",V),null}}calculateP95(V){if(V.length===0)return 0;const j=V.sort((nt,dt)=>nt-dt),tt=Math.ceil(j.length*.95)-1;return j[Math.max(0,tt)]}getPerformanceReport(){const V=this.getStoredData(),j=Date.now()-1440*60*1e3,tt=V.filter(t=>t.timestamp>j),nt=tt.filter(t=>t.metrics.lcp).map(t=>t.metrics.lcp.value),dt=tt.filter(t=>t.metrics.inp).map(t=>t.metrics.inp.value),g=tt.filter(t=>t.metrics.cls).map(t=>t.metrics.cls.value),A=tt.filter(t=>t.metrics.lcp?.rating===""good""&&t.metrics.inp?.rating===""good""&&t.metrics.cls?.rating===""good"").length;return{baseline:this.getBaseline(),recent:tt,summary:{totalSessions:new Set(tt.map(t=>t.sessionId)).size,avgLCP:nt.length?nt.reduce((t,c)=>t+c,0)/nt.length:0,avgINP:dt.length?dt.reduce((t,c)=>t+c,0)/dt.length:0,avgCLS:g.length?g.reduce((t,c)=>t+c,0)/g.length:0,goodRating:tt.length?A/tt.length*100:0}}}start(){!this.isEnabled&&this.config.enabled&&this.initialize()}stop(){this.isEnabled=!1,this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.flushTimer&&(clearInterval(this.flushTimer),this.flushTimer=null),this.flush(),console.log(""[WebVitalsCollector] 收集器已停止"")}destroy(){this.stop(),this.dataBuffer=[],console.log(""[WebVitalsCollector] 收集器已销毁"")}}let yc=null;const hC=st=>(yc||(yc=new lC(st)),yc);function uC(st={}){const{enabled:V=!0,componentName:j=""UnknownComponent"",trackRender:tt=!0,trackInteractions:nt=!0,collectorConfig:dt}=st,[g,A]=Yt.useState(null),[t,c]=Yt.useState(!0),m=Yt.useRef(0),o=Yt.useRef(new Map),s=Yt.useRef(V?Ay():null),r=Yt.useRef(V?hC(dt):null);Yt.useEffect(()=>{if(!V||!s.current)return;const u=s.current.subscribe(d=>{A(d),c(!1)});return A(s.current.getMetrics()),c(!1),u},[V]),Yt.useEffect(()=>{if(!(!V||!tt||!s.current))return m.current=performance.now(),s.current.mark(`${j}_render_start`),()=>{if(m.current>0){const u=performance.now()-m.current;s.current?.mark(`${j}_render_end`),s.current?.measure(`${j}_render`,`${j}_render_start`,`${j}_render_end`),u>50&&console.log(`[WebVitals] 组件""${j}""渲染耗时: ${u.toFixed(2)}ms`)}}},[V,tt,j]);const e=Yt.useCallback(u=>{if(!V||!s.current)return;const d=`${j}_${u}_start`,f=performance.now();o.current.set(u,f),s.current.mark(d)},[V,j]),n=Yt.useCallback(u=>{if(!V||!s.current)return;const d=o.current.get(u);if(!d){console.warn(`[WebVitals] 找不到计时开始标记: ${u}`);return}const p=performance.now()-d,x=`${j}_${u}_start`,S=`${j}_${u}_end`,y=`${j}_${u}`;return s.current.mark(S),s.current.measure(y,x,S),o.current.delete(u),console.log(`[WebVitals] ${j} - ${u}: ${p.toFixed(2)}ms`),p},[V,j]),h=Yt.useCallback((u,d)=>{!V||!s.current||s.current.recordInteraction(`${j}_${u}`,d)},[V,j]),i=Yt.useCallback((u,d)=>{!V||!s.current||s.current.recordEvent(`${j}_${u}`,d)},[V,j]),l=Yt.useCallback(()=>!V||!r.current?null:r.current.getPerformanceReport(),[V]);return{metrics:g,isLoading:t,startTiming:e,endTiming:n,recordInteraction:h,recordEvent:i,getPerformanceReport:l}}function fC(){const st=uC({enabled:!0,componentName:""App"",trackRender:!0,trackInteractions:!0,collectorConfig:{enabled:!0,sentryEnabled:!0,batchSize:5,flushInterval:15e3}});return Yt.useEffect(()=>{st.startTiming(""app_initialization"");const V=setTimeout(()=>{st.endTiming(""app_initialization"")},100);return()=>clearTimeout(V)},[st]),Ce.jsxDEV(""div"",{className:""app-container p-8 min-h-screen bg-game-ui-background"",children:[Ce.jsxDEV(""header"",{className:""text-center mb-8"",children:[Ce.jsxDEV(""h1"",{className:""text-game-title font-bold text-game-primary mb-4"",children:""Phaser 3 + React 19 + TypeScript""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:34,columnNumber:9},this),Ce.jsxDEV(""p"",{className:""text-game-subtitle text-game-ui-muted"",children:""符合 CLAUDE.md 技术栈要求的游戏开发环境""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:37,columnNumber:9},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:33,columnNumber:7},this),Ce.jsxDEV(""main"",{className:""flex justify-center"",children:Ce.jsxDEV(AE,{width:800,height:600,className:""shadow-lg""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:43,columnNumber:9},this)},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:42,columnNumber:7},this),Ce.jsxDEV(""footer"",{className:""text-center mt-8 text-game-ui-muted"",children:Ce.jsxDEV(""p"",{children:""🎮 技术栈：Electron + React 19 + Vite + Phaser 3 + Tailwind CSS v4 + TypeScript""},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:47,columnNumber:9},this)},void 0,!1,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:46,columnNumber:7},this)]},void 0,!0,{fileName:""C:/buildgame/vitegame/src/App.tsx"",lineNumber:32,columnNumber:5},this)}uE.createRoot(document.getElementById(""root"")).render(Ce.jsxDEV(Yt.StrictMode,{children:Ce.jsxDEV(fC,{},void 0,!1,{fileName:""C:/buildgame/vitegame/src/main.tsx"",lineNumber:8,columnNumber:5},void 0)},void 0,!1,{fileName:""C:/buildgame/vitegame/src/main.tsx"",lineNumber:7,columnNumber:3},void 0));","Do not use insertCSS, executeJavaScript, eval, Function, setTimeout, setInterval, setImmediate with user-supplied content",https://github.com/doyensec/electronegativity/wiki/DANGEROUS_FUNCTIONS_JS_CHECK
AUXCLICK_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\electron\main.ts","17:21","const mainWindow = new BrowserWindow({","Limit navigation flows to untrusted origins. Middle-click may cause Electron to open a link within a new window",https://github.com/doyensec/electronegativity/wiki/AUXCLICK_JS_CHECK
PRELOAD_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\electron\main.ts","23:6","preload: join(__dirname, '../preload/index.js'),","Review the use of preload scripts",https://github.com/doyensec/electronegativity/wiki/PRELOAD_JS_CHECK
AUXCLICK_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\electron\security.ts","39:9","return new BrowserWindow(secureOptions);","Limit navigation flows to untrusted origins. Middle-click may cause Electron to open a link within a new window",https://github.com/doyensec/electronegativity/wiki/AUXCLICK_JS_CHECK
CONTEXT_ISOLATION_JS_CHECK,"HIGH","FIRM","C:\buildgame\vitegame\electron\security.ts","39:9","return new BrowserWindow(secureOptions);","Review the use of the contextIsolation option",https://github.com/doyensec/electronegativity/wiki/CONTEXT_ISOLATION_JS_CHECK
SANDBOX_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\electron\security.ts","39:9","return new BrowserWindow(secureOptions);","Use sandbox for untrusted origins",https://github.com/doyensec/electronegativity/wiki/SANDBOX_JS_CHECK
OPEN_EXTERNAL_JS_CHECK,"MEDIUM","TENTATIVE","C:\buildgame\vitegame\electron\security.ts","63:4","shell.openExternal(url);","Review the use of openExternal",https://github.com/doyensec/electronegativity/wiki/OPEN_EXTERNAL_JS_CHECK
OPEN_EXTERNAL_JS_CHECK,"MEDIUM","TENTATIVE","C:\buildgame\vitegame\electron\security.ts","118:6","shell.openExternal(redirectUrl);","Review the use of openExternal",https://github.com/doyensec/electronegativity/wiki/OPEN_EXTERNAL_JS_CHECK
OPEN_EXTERNAL_JS_CHECK,"MEDIUM","TENTATIVE","C:\buildgame\vitegame\electron\security.ts","220:6","shell.openExternal(url);","Review the use of openExternal",https://github.com/doyensec/electronegativity/wiki/OPEN_EXTERNAL_JS_CHECK
OPEN_EXTERNAL_JS_CHECK,"MEDIUM","TENTATIVE","C:\buildgame\vitegame\electron\security\permissions.ts","276:8","shell.openExternal(url);","Review the use of openExternal",https://github.com/doyensec/electronegativity/wiki/OPEN_EXTERNAL_JS_CHECK
AUXCLICK_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\src\main\window.ts","5:14","const win = new BrowserWindow({","Limit navigation flows to untrusted origins. Middle-click may cause Electron to open a link within a new window",https://github.com/doyensec/electronegativity/wiki/AUXCLICK_JS_CHECK
PRELOAD_JS_CHECK,"MEDIUM","FIRM","C:\buildgame\vitegame\src\main\window.ts","10:6","preload: path.join(__dirname, 'preload', 'bridge.js'),","Review the use of preload scripts",https://github.com/doyensec/electronegativity/wiki/PRELOAD_JS_CHECK
